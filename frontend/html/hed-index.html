<!DOCTYPE html>
<html lang="en" class="light-style layout-menu-fixed" dir="ltr" data-theme="theme-default" data-assets-path="../assets/" data-template="vertical-menu-template-free">

<head>
  <meta charset="utf-8" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

  <title>Higher Official Dashboard | Fake Degree Recognition System</title>

  <link rel="icon" type="image/x-icon" href="../assets/img/favicon/favicon.ico" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Public+Sans&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="../assets/vendor/fonts/boxicons.css" />
  <link rel="stylesheet" href="../assets/vendor/css/core.css" />
  <link rel="stylesheet" href="../assets/vendor/css/theme-default.css" />
  <link rel="stylesheet" href="../assets/css/demo.css" />
  <link rel="stylesheet" href="../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />
  <link rel="stylesheet" href="../assets/vendor/libs/apex-charts/apex-charts.css" />

  <script src="../assets/vendor/js/helpers.js"></script>
  <script src="../assets/js/config.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=UnifrakturCook:wght@700&family=Playfair+Display:wght@700&family=Yeseva+One&display=swap" rel="stylesheet" />
  <style>
    .logo-text { font-family: 'UnifrakturCook', 'Playfair Display', 'Yeseva One', serif; font-weight:700; letter-spacing:1px; text-transform:none; font-size:28px; color:#0f172a; line-height:1; white-space:nowrap; }
  </style>
</head>

<body>
  <div class="layout-wrapper layout-content-navbar">
    <div class="layout-container">
                <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
          <div class="app-brand demo">
            <a href="hed-index.html" class="app-brand-link">
              <span class="logo-text">Sachpatr</span>
            </a>

            <a href="javascript:void(0);" class="layout-menu-toggle menu-link text-large ms-auto d-block d-xl-none">
              <i class="bx bx-chevron-left bx-sm align-middle"></i>
            </a>
          </div>

          <div class="menu-inner-shadow"></div>

          <ul class="menu-inner py-1">
            <!-- Dashboard -->
            <li class="menu-item active">
              <a href="hed-index.html" class="menu-link">
                <i class="menu-icon tf-icons bx bx-shield-quarter"></i>
                <div data-i18n="Analytics">Dashboard</div>
              </a>
            </li>

            <!-- Layouts -->
            <li class="menu-item">
              <a href="alerts.html" class="menu-link">
                <i class="menu-icon tf-icons bx bx-bell"></i>
                <div data-i18n="Layouts">Alerts</div>
              </a>
            </li>
            <li class="menu-item">
              <a href="blacklist.html" class="menu-link">
                <i class="menu-icon tf-icons bx bx-user-x"></i>
                <div data-i18n="Layouts">Blacklist Users</div>
              </a>
            </li>
          </ul>
        </aside>


      <div class="layout-page">

        <nav class="layout-navbar container-xxl navbar navbar-expand-xl navbar-detached bg-navbar-theme">
          <div class="navbar-nav-right d-flex align-items-center">
            <h4>Fake Degree Recognition System - Official Dashboard</h4>
          </div>
        </nav>

        <div class="content-wrapper">
          <div class="container-xxl flex-grow-1 container-p-y">

            <div class="row">

              <!-- Total Certificates Verified Card -->
              <div class="col-lg-4 col-md-6 mb-4">
            <div class="card">
                  <div class="card-body">
                    <div class="card-title d-flex align-items-start justify-content-between">
                      <div class="avatar flex-shrink-0">
                        <span class="avatar-initial rounded bg-label-primary"><i class="bx bx-file-check"></i></span>
                      </div>
                    </div>
                    <h5 class="card-title">Certificates Verified</h5>
                <h3 id="hed-verified">0</h3>
                    <small class="text-success"><i class="bx bx-up-arrow-alt"></i> +15% from last month</small>
                  </div>
                </div>
              </div>

              <!-- Fake Certificates Detected Card -->
              <div class="col-lg-4 col-md-6 mb-4">
                <div class="card">
                  <div class="card-body">
                    <div class="card-title d-flex align-items-start justify-content-between">
                      <div class="avatar flex-shrink-0">
                        <span class="avatar-initial rounded bg-label-danger"><i class="bx bx-error"></i></span>
                      </div>
                    </div>
                    <h5 class="card-title">Fake Certificates Detected</h5>
                    <h3 id="hed-flagged">0</h3>
                    <small class="text-warning"><i class="bx bx-exclamation-circle"></i> +7 this month</small>
                  </div>
                </div>
              </div>

              <!-- Recent Alerts Card -->
              <div class="col-lg-4 col-md-12 mb-4">
                <div class="card">
                  <div class="card-body">
                    <div class="card-title d-flex align-items-start justify-content-between">
                      <div class="avatar flex-shrink-0">
                        <span class="avatar-initial rounded bg-label-info"><i class="bx bx-bell-ring"></i></span>
                      </div>
                    </div>
                    <h5 class="card-title">Recent Alerts</h5>
                    <h3>240</h3>
                    <small class="text-muted"><i class="bx bx-info-circle"></i> Alerts sent to officials</small>
                  </div>
                </div>
              </div>

              <!-- Forgery Trends Chart -->
              <div class="col-lg-12 mb-4">
                <div class="card">
                  <h5 class="card-header">Forgery Trends Analytics</h5>
                  <div class="card-body">
                    <div id="forgeryTrendsChart" style="height: 300px;"></div>
                  </div>
                </div>
              </div>

            </div>

          </div>

          <footer class="content-footer footer bg-footer-theme">
            <div class="container-xxl d-flex justify-content-between py-2">
              Â© <script>document.write(new Date().getFullYear());</script>, Government of Jharkhand
            </div>
          </footer>
        </div>

      </div>

    </div>

    <div class="layout-overlay layout-menu-toggle"></div>
  </div>

  <script src="../assets/vendor/libs/jquery/jquery.js"></script>
  <script src="../assets/vendor/libs/popper/popper.js"></script>
  <script src="../assets/vendor/js/bootstrap.js"></script>
  <script src="../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>
  <script src="../assets/vendor/js/menu.js"></script>
  <script src="../assets/vendor/libs/apex-charts/apexcharts.js"></script>
  <script src="../assets/js/main.js"></script>

  <script>
    function getLocalUploads() {
      try { const raw = localStorage.getItem('userCertificates'); return raw ? JSON.parse(raw) : []; } catch(_) { return []; }
    }

    function computeStats(list) {
      let verified = 0, flagged = 0; const months = Array(12).fill(0);
      list.forEach(it => {
        const combined = typeof it.scores?.combined === 'number' ? it.scores.combined : 0;
        if (combined >= 80) verified++; else if (combined < 60) flagged++;
        const m = it.uploadDate ? new Date(it.uploadDate).getMonth() : null; if (m !== null) months[m]++;
      });
      return { verified, flagged, months };
    }

    function renderHED() {
      const list = getLocalUploads();
      const stats = computeStats(list);
      const v = document.getElementById('hed-verified'); if (v) v.textContent = String(stats.verified);
      const f = document.getElementById('hed-flagged'); if (f) f.textContent = String(stats.flagged);

      const options = {
        chart: { type: 'line', height: 300 },
        series: [{ name: 'Uploads', data: stats.months }],
        xaxis: { categories: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'] }
      };
      const el = document.querySelector('#forgeryTrendsChart');
      if (el) {
        el.innerHTML = '';
        new ApexCharts(el, options).render();
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      renderHED();
      window.addEventListener('storage', (e) => { if (!e || e.key === null || e.key === 'userCertificates') renderHED(); });
      window.addEventListener('focus', renderHED);
      document.addEventListener('visibilitychange', () => { if (document.visibilityState === 'visible') renderHED(); });
      setInterval(renderHED, 2000);
    });
  </script>
</body>
</html>
