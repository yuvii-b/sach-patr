<!DOCTYPE html>
<html lang="en" class="light-style layout-menu-fixed" dir="ltr" data-theme="theme-default" data-assets-path="../assets/" data-template="vertical-menu-template-free">

<head>
  <meta charset="utf-8" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

  <title>Blacklist | Fake Degree Recognition System</title>

  <link rel="icon" type="image/x-icon" href="../assets/img/favicon/favicon.ico" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Public+Sans&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="../assets/vendor/fonts/boxicons.css" />
  <link rel="stylesheet" href="../assets/vendor/css/core.css" />
  <link rel="stylesheet" href="../assets/vendor/css/theme-default.css" />
  <link rel="stylesheet" href="../assets/css/demo.css" />
  <link rel="stylesheet" href="../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />
  <link rel="stylesheet" href="../assets/vendor/libs/apex-charts/apex-charts.css" />

  <script src="../assets/vendor/js/helpers.js"></script>
  <script src="../assets/js/config.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=UnifrakturCook:wght@700&family=Playfair+Display:wght@700&family=Yeseva+One&display=swap" rel="stylesheet" />
  <style>
    .logo-text { font-family: 'UnifrakturCook', 'Playfair Display', 'Yeseva One', serif; font-weight:700; letter-spacing:1px; text-transform:none; font-size:28px; color:#0f172a; line-height:1; white-space:nowrap; }
  </style>
</head>

<body>
  <div class="layout-wrapper layout-content-navbar">
    <div class="layout-container">
                <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
          <div class="app-brand demo">
            <a href="hed-index.html" class="app-brand-link">
              <span class="logo-text">Sachpatr</span>
            </a>

            <a href="javascript:void(0);" class="layout-menu-toggle menu-link text-large ms-auto d-block d-xl-none">
              <i class="bx bx-chevron-left bx-sm align-middle"></i>
            </a>
          </div>

          <div class="menu-inner-shadow"></div>

          <ul class="menu-inner py-1">
            <!-- Dashboard -->
            <li class="menu-item">
              <a href="hed-index.html" class="menu-link">
                <i class="menu-icon tf-icons bx bx-shield-quarter"></i>
                <div data-i18n="Analytics">Dashboard</div>
              </a>
            </li>

            <!-- Layouts -->
            <li class="menu-item">
              <a href="alerts.html" class="menu-link">
                <i class="menu-icon tf-icons bx bx-bell"></i>
                <div data-i18n="Layouts">Alerts</div>
              </a>
            </li>
            <li class="menu-item active">
              <a href="blacklist.html" class="menu-link">
                <i class="menu-icon tf-icons bx bx-user-x"></i>
                <div data-i18n="Layouts">Blacklist User</div>
              </a>
            </li>
          </ul>
        </aside>

      <div class="layout-page">
        <div class="content-wrapper">
          <div class="container-xxl flex-grow-1 container-p-y">

            <!-- Blacklist Filters / Search -->
            <div class="card mb-4">
              <h5 class="card-header">Search Blacklisted Certificates / Users</h5>
              <div class="card-body">
                <div class="input-group">
                  <input type="text" class="form-control" placeholder="Enter Certificate ID or User Name" />
                  <button class="btn btn-primary" type="button">Search</button>
                </div>
              </div>
            </div>

            <!-- Blacklisted Certificates Table -->
            <div class="card">
              <h5 class="card-header">Blacklisted Certificates & Users</h5>
              <div class="card-body table-responsive">
                <table class="table table-hover">
                  <thead>
                    <tr>
                      <th>#</th>
                      <th>Certificate ID</th>
                      <th>User / Institution</th>
                      <th>Date Added</th>
                      <th>Reason</th>
                      <th>Action</th>
                    </tr>
                  </thead>
                  <tbody id="blacklist-body"></tbody>
                </table>
              </div>
            </div>

          </div>

          <footer class="content-footer footer bg-footer-theme">
            <div class="container-xxl d-flex justify-content-between py-2">
              Â© <script>document.write(new Date().getFullYear());</script>, Government of Jharkhand
            </div>
          </footer>
        </div>
      </div>

    </div>
  </div>
  <script>
    function getLocalUploads() {
      try { const raw = localStorage.getItem('userCertificates'); return raw ? JSON.parse(raw) : []; } catch(_) { return []; }
    }
    function renderBlacklist() {
      const body = document.getElementById('blacklist-body'); if (!body) return;
      const bad = getLocalUploads().filter(it => (it.scores?.combined ?? 0) < 60);
      body.innerHTML = bad.map((it, i) => `
        <tr>
          <td>${i+1}</td>
          <td>${it.certificateId || '-'}</td>
          <td>${it.fields?.name || it.fields?.issuer || 'N/A'}</td>
          <td>${(it.uploadDate && new Date(it.uploadDate).toISOString().slice(0,10)) || '-'}</td>
          <td>Low authenticity score (${it.scores?.combined ?? 0}%)</td>
          <td><button class="btn btn-sm btn-danger" onclick="this.closest('tr').remove()">Remove</button></td>
        </tr>`).join('') || '<tr><td colspan="6" class="text-center text-muted">No blacklisted entries</td></tr>';
    }
    document.addEventListener('DOMContentLoaded', () => {
      renderBlacklist();
      window.addEventListener('storage', (e) => { if (!e || e.key === null || e.key === 'userCertificates') renderBlacklist(); });
      window.addEventListener('focus', renderBlacklist);
      document.addEventListener('visibilitychange', () => { if (document.visibilityState === 'visible') renderBlacklist(); });
      setInterval(renderBlacklist, 2000);
    });
  </script>
</body>
</html>
